@using System.Linq
@using NetFabric.Hyperlinq
@using Nncase
@model Nncase.Targets.CpuTargetOptions
@{
  var hierarchy = Model.Hierarchies[0];
}

#pragma once
#include <array>
#include <cstddef>

namespace nncase::ntt::distributed {
    constexpr std::array<size_t, @(hierarchy.Length)> topology_dims = {@(string.Join(", ", hierarchy))};
    using topology_shape_t = ntt::fixed_shape<@(string.Join(", ", Enumerable.Repeat(1, 3 - hierarchy.Length).Concat(hierarchy)))>;
}
