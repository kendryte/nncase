@using System.Linq
@using NetFabric.Hyperlinq
@using Nncase
@model Nncase.Targets.NTTTargetOptions
@{
  var hierarchy = Model.Hierarchies[0];
}

#pragma once
#include <nncase/ntt/shape.h>

namespace nncase::ntt::distributed {
    constexpr auto topology_shape = ntt::fixed_shape_v<@(string.Join(", ", Enumerable.Repeat(1, 3 - hierarchy.Length).Concat(hierarchy)))>;
}
